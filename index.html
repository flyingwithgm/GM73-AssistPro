<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GM73 Assist Pro - Offline emergency medical guidance">
    <meta name="theme-color" content="#0d47a1">
    <link rel="manifest" href="manifest.json">
    <title>GM73 Assist Pro - First Response. Zero Delay.</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- Massive CSS Upgrade --- */

        :root {
            --primary: #0d47a1;
            --secondary: #e53935;
            --accent: #00bcd4;
            --light: #f5f5f5;
            --dark: #212121;
            --success: #43a047;
            --warning: #ff9800;
            --glass: rgba(255,255,255,0.2);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            --blur: blur(12px);
        }

        [data-theme="dark"] {
            --primary: #1565c0;
            --secondary: #f44336;
            --accent: #00b8d4;
            --light: #212121;
            --dark: #f5f5f5;
            --glass: rgba(33,33,33,0.5);
        }

        body {
            background: linear-gradient(135deg, var(--primary) 60%, var(--accent) 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background 0.7s cubic-bezier(.75,.1,.15,1), color 0.3s;
        }

        .container {
            max-width: 700px;
            margin: 40px auto 0 auto;
            background: var(--glass);
            backdrop-filter: var(--blur);
            box-shadow: var(--shadow);
            border-radius: 30px;
            padding: 24px;
            position: relative;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .logo i {
            color: var(--secondary);
            font-size: 2.2rem;
            filter: drop-shadow(0 0 4px var(--accent));
            animation: pulse 2s infinite;
        }

        .logo h1 {
            font-size: 1.7rem;
            color: var(--primary);
            font-weight: bold;
            letter-spacing: 1px;
        }

        .tagline {
            font-size: 1rem;
            color: var(--secondary);
            font-weight: bold;
        }

        .theme-toggle, .language-toggle, .accessibility-toggle {
            background: none;
            border: none;
            font-size: 1.4rem;
            color: var(--dark);
            cursor: pointer;
            margin-left: 10px;
        }

        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
            gap: 18px;
            margin-bottom: 24px;
        }

        .emergency-btn {
            background: linear-gradient(135deg, var(--primary) 70%, var(--accent) 120%);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 22px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            box-shadow: 0 8px 28px rgba(0,0,0,0.25);
            transition: transform 0.2s, box-shadow 0.2s, background 0.5s;
            position: relative;
            overflow: hidden;
        }
        .emergency-btn:after {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 60% 40%, var(--accent) 0%, transparent 85%);
            opacity: 0.15;
        }
        .emergency-btn:active {
            transform: scale(0.97) rotate(-1deg);
            box-shadow: 0 4px 14px rgba(0,0,0,0.18);
        }
        .emergency-btn i {
            font-size: 2.3rem;
            filter: drop-shadow(0 0 6px var(--accent));
            animation: shake 1.2s infinite;
        }
        .emergency-btn span {
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
        }

        .panic-btn {
            width: 100%;
            background: linear-gradient(90deg, var(--secondary) 60%, var(--warning) 100%);
            color: white;
            border: none;
            border-radius: 16px;
            padding: 18px;
            font-weight: bold;
            margin-bottom: 22px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255,0,0,0.13);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            font-size: 1.2rem;
            position: relative;
            animation: pulse 2s infinite;
        }

        .progress-container {
            width: 100%;
            background: rgba(0,0,0,0.1);
            border-radius: 7px;
            margin: 10px 0 24px 0;
            height: 14px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--accent));
            border-radius: 7px;
            width: 0%;
            transition: width 0.3s;
        }

        .guide-container {
            display: none;
            background: var(--glass);
            backdrop-filter: blur(6px);
            border-radius: 22px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 22px;
            animation: fadeIn 0.5s;
        }
        .guide-container.active {
            display: block;
        }
        .guide-title {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        .guide-step {
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 4px solid var(--primary);
            font-size: 1.1rem;
            background: rgba(0,0,0,0.03);
            border-radius: 9px;
        }
        .guide-actions {
            display: flex;
            gap: 12px;
            margin-top: 28px;
        }
        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            transition: background 0.2s, color 0.2s, transform 0.2s;
        }
        .yes-btn { background: var(--success); color: white; }
        .no-btn { background: var(--secondary); color: white; }
        .next-btn { background: var(--primary); color: white; }
        .back-btn { background: var(--warning); color: white; }

        .voice-toggle, .fab-btn, .accessibility-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 54px; height: 54px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(0,0,0,0.14);
            z-index: 100;
            font-size: 1.6rem;
            transition: background 0.3s;
        }
        .fab-btn {
            bottom: 90px;
            right: 20px;
            background: linear-gradient(135deg, var(--secondary), var(--warning));
        }
        .fab-btn i {
            animation: pulse 2s infinite;
        }
        .accessibility-toggle {
            bottom: 20px;
            right: 90px;
            background: linear-gradient(135deg, var(--accent), var(--success));
        }
        .pulse { animation: pulse 2s infinite; }
        .shake { animation: shake 1.3s infinite; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.09); }
            100% { transform: scale(1); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98);}
            to { opacity: 1; transform: scale(1);}
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0);}
            25%, 75% { transform: translateX(-3px);}
            50% { transform: translateX(3px);}
        }

        /* Custom Modal for incident log, checklist, reminders */
        .modal {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: 28px;
            box-shadow: var(--shadow);
            padding: 32px 24px;
            min-width: 320px;
            min-height: 180px;
            display: none;
        }
        .modal.active { display: block; animation: fadeIn 0.5s;}

        .modal-header {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 18px;
        }
        .modal-close {
            position: absolute;
            top: 18px; right: 22px;
            background: none; border: none;
            font-size: 1.2rem; color: var(--secondary);
            cursor: pointer;
        }
        /* Toast/Notification */
        .toast {
            position: fixed;
            top: 28px;
            right: 30px;
            background: linear-gradient(90deg, var(--success), var(--accent));
            color: white;
            padding: 14px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.13);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            animation: fadeIn 0.5s forwards;
        }

        /* Accessibility Controls */
        .accessibility-panel {
            position: fixed;
            bottom: 80px;
            right: 90px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 18px;
            border-radius: 24px;
            box-shadow: var(--shadow);
            display: none;
            z-index: 9999;
        }
        .accessibility-panel.active { display: block; }
        .accessibility-panel label { display: block; margin: 10px 0 4px; }
        .accessibility-panel input[type="range"] { width: 100%; }
        .accessibility-panel button { margin-top: 10px; }

        /* Accessibility: font size, contrast */
        html.access-large { font-size: 22px;}
        html.access-contrast { filter: contrast(1.3);}

        /* Responsive improvements */
        @media (max-width: 600px) {
            .container {margin: 0 0; border-radius: 0; padding: 10px;}
            .modal {min-width: 90vw;}
        }
        @media (max-width: 400px) {
            .emergency-grid { grid-template-columns: 1fr;}
            .emergency-btn { padding: 13px;}
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-first-aid"></i>
                <div>
                    <h1 id="mainTitle">GM73 Assist Pro</h1>
                    <p class="tagline">First Response. Zero Delay.</p>
                </div>
            </div>
            <div>
                <button class="theme-toggle" id="themeToggle" title="Toggle theme"><i class="fas fa-moon"></i></button>
                <button class="language-toggle" id="languageToggle" title="Change language"><i class="fas fa-globe"></i></button>
                <button class="accessibility-toggle" id="accessToggle" title="Accessibility options"><i class="fas fa-universal-access"></i></button>
            </div>
        </header>

        <button class="panic-btn pulse" id="panicBtn">
            <i class="fas fa-bell"></i> EMERGENCY PANIC MODE
        </button>

        <div class="emergency-grid">
            <button class="emergency-btn" data-emergency="unconscious">
                <i class="fas fa-procedures"></i>
                <span data-i18n="Unconscious Person">Unconscious Person</span>
            </button>
            <button class="emergency-btn" data-emergency="bleeding">
                <i class="fas fa-tint"></i>
                <span data-i18n="Severe Bleeding">Severe Bleeding</span>
            </button>
            <button class="emergency-btn" data-emergency="burn">
                <i class="fas fa-fire"></i>
                <span data-i18n="Burn Injury">Burn Injury</span>
            </button>
            <button class="emergency-btn" data-emergency="fracture">
                <i class="fas fa-bone"></i>
                <span data-i18n="Broken Bone">Broken Bone</span>
            </button>
            <button class="emergency-btn" data-emergency="choking">
                <i class="fas fa-lungs"></i>
                <span data-i18n="Choking">Choking</span>
            </button>
            <button class="emergency-btn" data-emergency="seizure">
                <i class="fas fa-brain"></i>
                <span data-i18n="Seizure">Seizure</span>
            </button>
            <button class="emergency-btn" data-emergency="allergy">
                <i class="fas fa-allergies"></i>
                <span data-i18n="Allergic Reaction">Allergic Reaction</span>
            </button>
            <button class="emergency-btn" data-emergency="notes">
                <i class="fas fa-notes-medical"></i>
                <span data-i18n="My Medical Notes">My Medical Notes</span>
            </button>
            <button class="emergency-btn" data-emergency="checklist">
                <i class="fas fa-kit-medical"></i>
                <span data-i18n="First Aid Kit">First Aid Kit</span>
            </button>
            <button class="emergency-btn" data-emergency="log">
                <i class="fas fa-clipboard-list"></i>
                <span data-i18n="Incident Log">Incident Log</span>
            </button>
            <button class="emergency-btn" data-emergency="reminders">
                <i class="fas fa-pills"></i>
                <span data-i18n="Reminders">Reminders</span>
            </button>
        </div>

        <div class="guide-container" id="guideContainer">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <h2 class="guide-title" id="guideTitle"></h2>
            <div id="guideContent"></div>
            <div class="guide-actions" id="guideActions"></div>
        </div>
    </div>

    <!-- Floating Buttons -->
    <button class="voice-toggle" id="voiceToggle" title="Toggle voice">
        <i class="fas fa-volume-up"></i>
    </button>
    <button class="fab-btn" id="fabWidget" title="Quick Panic/Call">
        <i class="fas fa-phone-volume"></i>
    </button>

    <!-- Accessibility Panel -->
    <div class="accessibility-panel" id="accessPanel">
        <label for="fontSize">Font Size</label>
        <input type="range" id="fontSize" min="16" max="28" value="18">
        <label>
            <input type="checkbox" id="contrastToggle"> High Contrast
        </label>
        <button id="closeAccessPanel">Close</button>
    </div>

    <!-- Modals -->
    <div class="modal" id="modalChecklist">
        <button class="modal-close" onclick="closeModal('modalChecklist')"><i class="fas fa-times"></i></button>
        <div class="modal-header">First Aid Kit Checklist</div>
        <div id="modalChecklistContent"></div>
    </div>
    <div class="modal" id="modalLog">
        <button class="modal-close" onclick="closeModal('modalLog')"><i class="fas fa-times"></i></button>
        <div class="modal-header">Incident Log</div>
        <div id="modalLogContent"></div>
    </div>
    <div class="modal" id="modalReminders">
        <button class="modal-close" onclick="closeModal('modalReminders')"><i class="fas fa-times"></i></button>
        <div class="modal-header">Medication/Allergy Reminders</div>
        <div id="modalRemindersContent"></div>
    </div>
    <div class="modal" id="modalLocation">
        <button class="modal-close" onclick="closeModal('modalLocation')"><i class="fas fa-times"></i></button>
        <div class="modal-header">Share Location</div>
        <div id="modalLocationContent"></div>
    </div>
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- SVG Illustrations (Visual Step Demo) -->
    <div id="svgIllustration" style="display:none;position:fixed;top:8vh;left:50vw;z-index:888;"></div>

    <script>
    // --- Massive Feature JS Scaffolding ---
    const config = {
        voiceEnabled: false,
        currentTheme: 'light',
        currentLanguage: 'en',
        currentEmergency: null,
        currentStep: 0,
        decisionPath: [],
        incidentLog: [],
        reminders: [],
        firstAidKit: [
            {item: "Bandages", have: false},
            {item: "Antiseptic wipes", have: false},
            {item: "Adhesive tape", have: false},
            {item: "Scissors", have: false},
            {item: "Gloves", have: false},
            {item: "Painkillers", have: false},
            {item: "CPR mask", have: false},
            {item: "Tweezers", have: false}
        ]
    };
    // Emergency Decision Trees (same as before, can be extended for language support)
    const emergencyData = {
        unconscious: { /* ...same as before... */ },
        bleeding: { /* ...same as before... */ },
        burn: { /* ...same as before... */ },
        choking: { /* ...same as before... */ },
        panic: { /* ...same as before... */ },
        notes: { /* ...same as before... */ }
        // Add more emergencies as needed
    };

    // Multi-language support demo (simple dictionary)
    const i18n = {
        en: {
            "Unconscious Person": "Unconscious Person",
            "Severe Bleeding": "Severe Bleeding",
            "Burn Injury": "Burn Injury",
            "Broken Bone": "Broken Bone",
            "Choking": "Choking",
            "Seizure": "Seizure",
            "Allergic Reaction": "Allergic Reaction",
            "My Medical Notes": "My Medical Notes",
            "First Aid Kit": "First Aid Kit",
            "Incident Log": "Incident Log",
            "Reminders": "Reminders"
        },
        es: {
            "Unconscious Person": "Persona Inconsciente",
            "Severe Bleeding": "Sangrado Grave",
            "Burn Injury": "Quemadura",
            "Broken Bone": "Fractura",
            "Choking": "Atragantamiento",
            "Seizure": "Convulsión",
            "Allergic Reaction": "Reacción Alérgica",
            "My Medical Notes": "Mis Datos Médicos",
            "First Aid Kit": "Botiquín",
            "Incident Log": "Registro de Incidentes",
            "Reminders": "Recordatorios"
        }
        // Add more languages
    };

    // DOM Elements
    const themeToggle = document.getElementById('themeToggle');
    const voiceToggle = document.getElementById('voiceToggle');
    const panicBtn = document.getElementById('panicBtn');
    const emergencyBtns = document.querySelectorAll('.emergency-btn');
    const guideContainer = document.getElementById('guideContainer');
    const guideTitle = document.getElementById('guideTitle');
    const guideContent = document.getElementById('guideContent');
    const guideActions = document.getElementById('guideActions');
    const progressBar = document.getElementById('progressBar');
    const languageToggle = document.getElementById('languageToggle');
    const fabWidget = document.getElementById('fabWidget');
    const accessToggle = document.getElementById('accessToggle');
    const accessPanel = document.getElementById('accessPanel');
    const fontSize = document.getElementById('fontSize');
    const contrastToggle = document.getElementById('contrastToggle');
    const closeAccessPanel = document.getElementById('closeAccessPanel');
    const toast = document.getElementById('toast');
    const svgIllustration = document.getElementById('svgIllustration');

    // Modals
    function openModal(id) { document.getElementById(id).classList.add('active'); }
    function closeModal(id) { document.getElementById(id).classList.remove('active'); }

    // Accessibility
    accessToggle.addEventListener('click', ()=>{ accessPanel.classList.toggle('active'); });
    fontSize.addEventListener('input', ()=>{ document.documentElement.style.fontSize = fontSize.value+'px'; });
    contrastToggle.addEventListener('change', ()=>{ document.documentElement.classList.toggle('access-contrast', contrastToggle.checked); });
    closeAccessPanel.addEventListener('click', ()=>{ accessPanel.classList.remove('active'); });

    // Widget/FAB
    fabWidget.addEventListener('click', ()=>{ startEmergency('panic'); showToast('Quick panic mode activated!'); });

    // Language
    languageToggle.addEventListener('click', ()=>{
        config.currentLanguage = (config.currentLanguage === 'en') ? 'es' : 'en';
        updateLanguage();
        showToast('Language switched');
    });
    function updateLanguage() {
        document.querySelectorAll('[data-i18n]').forEach(el=>{
            const key = el.getAttribute('data-i18n');
            el.textContent = i18n[config.currentLanguage][key] || key;
        });
        document.getElementById('mainTitle').textContent = "GM73 Assist Pro";
    }

    // Massive Theme
    function setTheme(theme) {
        config.currentTheme = theme;
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        themeToggle.innerHTML = `<i class="fas ${theme === 'dark' ? 'fa-sun' : 'fa-moon'}"></i>`;
    }
    function toggleTheme() {
        setTheme(config.currentTheme === 'light' ? 'dark' : 'light');
    }
    themeToggle.addEventListener('click', toggleTheme);

    // Auto-dark mode (time-based)
    function autoDarkMode() {
        const hour = new Date().getHours();
        if (hour > 19 || hour < 7) setTheme('dark');
        else setTheme('light');
    }
    autoDarkMode();

    // Voice
    function updateVoiceToggle() {
        voiceToggle.innerHTML = `<i class="fas ${config.voiceEnabled ? 'fa-volume-up' : 'fa-volume-mute'}"></i>`;
    }
    function toggleVoice() {
        config.voiceEnabled = !config.voiceEnabled;
        localStorage.setItem('voiceEnabled', config.voiceEnabled);
        updateVoiceToggle();
        if (config.voiceEnabled && guideContainer.classList.contains('active')) speakCurrentStep();
    }
    voiceToggle.addEventListener('click', toggleVoice);

    function speak(text) {
        if (!config.voiceEnabled) return;
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }
    }
    function speakCurrentStep() {
        const text = guideTitle.textContent + '. ' + guideContent.textContent;
        speak(text);
    }

    // Emergency Guide (main)
    function startEmergency(emergencyType) {
        config.currentEmergency = emergencyType;
        config.currentStep = 0;
        config.decisionPath = [0];
        guideContainer.classList.add('active');
        renderStep();
    }
    function renderStep() {
        // ...same logic as before...
        // For illustration demo:
        if(config.currentStep === 1 && config.currentEmergency === "bleeding") {
            // Example: show SVG illustration
            svgIllustration.style.display = "block";
            svgIllustration.innerHTML = `
                <svg width="100" height="60"><ellipse cx="50" cy="30" rx="40" ry="20" fill="#e53935"/><text x="50" y="35" text-anchor="middle" fill="#fff" font-size="18">Bleeding</text></svg>
            `;
        } else {
            svgIllustration.style.display = "none";
        }
    }

    // Panic Button
    panicBtn.addEventListener('click', ()=>{ startEmergency('panic'); showToast('Panic Mode Activated'); });

    // Emergency buttons
    emergencyBtns.forEach(btn=>{
        btn.addEventListener('click', function(){
            const emergencyType = this.getAttribute('data-emergency');
            if(emergencyType==='checklist') openChecklist();
            else if(emergencyType==='log') openLog();
            else if(emergencyType==='reminders') openReminders();
            else startEmergency(emergencyType);
        });
    });

    // Toast Notification
    function showToast(msg) {
        toast.textContent = msg;
        toast.style.opacity = 1;
        setTimeout(()=>{ toast.style.opacity = 0; }, 2200);
    }

    // Location Sharing
    function openLocationModal() {
        openModal('modalLocation');
        const locContent = document.getElementById('modalLocationContent');
        locContent.innerHTML = `<button onclick="shareLocation()">Share My Location</button><div id="locationStatus"></div>`;
    }
    window.shareLocation = function() {
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(pos=>{
                const {latitude, longitude} = pos.coords;
                document.getElementById('locationStatus').textContent = `Location: ${latitude}, ${longitude}`;
                // For demo: pretend to send SMS or email
                showToast("Location shared with emergency contact!");
            }, ()=>{ document.getElementById('locationStatus').textContent = "Unable to access location."; });
        }
    }

    // First Aid Kit Checklist
    function openChecklist() {
        openModal('modalChecklist');
        const cont = document.getElementById('modalChecklistContent');
        cont.innerHTML = config.firstAidKit.map((item,i)=>
            `<label>
                <input type="checkbox" ${item.have?'checked':''} onchange="toggleKitItem(${i})">
                ${item.item}
            </label>`
        ).join('');
    }
    window.toggleKitItem = function(idx) {
        config.firstAidKit[idx].have = !config.firstAidKit[idx].have;
        showToast(config.firstAidKit[idx].item + (config.firstAidKit[idx].have ? " checked!" : " unchecked!"));
    }

    // Incident Log
    function openLog() {
        openModal('modalLog');
        const cont = document.getElementById('modalLogContent');
        cont.innerHTML = `
            <button onclick="logIncident()">Log New Incident</button>
            <ul>${config.incidentLog.map(inc=>`<li>${inc.date}: ${inc.type}</li>`).join('')}</ul>
        `;
    }
    window.logIncident = function() {
        const type = prompt("Incident type?");
        const note = prompt("Notes?");
        config.incidentLog.push({date: new Date().toLocaleString(), type, note});
        openLog();
        showToast("Incident logged!");
    }

    // Reminders
    function openReminders() {
        openModal('modalReminders');
        const cont = document.getElementById('modalRemindersContent');
        cont.innerHTML = `
            <button onclick="addReminder()">Add Reminder</button>
            <ul>${config.reminders.map(rem=>`<li>${rem.time}: ${rem.text}</li>`).join('')}</ul>
        `;
    }
    window.addReminder = function() {
        const text = prompt("Reminder text?");
        const time = prompt("Time?");
        config.reminders.push({text, time});
        openReminders();
        showToast("Reminder added!");
    }

    // Offline Mode (download guides)
    function enableOffline() {
        // This is a stub: real implementation needs Service Worker etc.
        showToast("Offline mode enabled (demo)");
    }

    // Customizable Guides (stub)
    function customizeGuides() {
        showToast("Custom guide editor coming soon!");
    }

    // Init
    document.addEventListener('DOMContentLoaded', ()=>{
        setTheme(localStorage.getItem('theme')||'light');
        config.voiceEnabled = localStorage.getItem('voiceEnabled')==='true';
        updateVoiceToggle();
        updateLanguage();
        // ...other init...
    });

    // Emergency Call & SMS (stub)
    function emergencyCall() {
        window.open("tel:112"); // Example: 112 is emergency number in Europe
        showToast("Calling emergency services...");
    }
    function sendEmergencySMS() {
        // Demo: just show toast
        showToast("Emergency SMS sent!");
    }

    // Global Keyboard Shortcuts (accessibility)
    document.addEventListener('keydown', function(e){
        if(e.key==='Escape') { // Close modals/guides
            document.querySelectorAll('.modal.active').forEach(m=>m.classList.remove('active'));
            guideContainer.classList.remove('active');
        }
    });

    </script>
</body>
</html>
